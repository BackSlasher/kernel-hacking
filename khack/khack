#!/usr/bin/python

"""KernelTLV Linux Hacking Utility

Usage:
    khack
    khack <command> [<args>...]

Available commands:
    kernel - Commands to get, compile and hack on the Linux kernel
    module - Commands to help with building your own kernel modules
    libc - Commands to get, compile and hack on glibc (soon)
"""

import codecs
import sys

from docopt import docopt
from subprocess import call

UTF8Writer = codecs.getwriter('utf8')
sys.stdout = UTF8Writer(sys.stdout)

home_dir = '/home/vagrant'
linux_source = '/home/vagrant/linux-source'
libc_source = '/home/vagrant/glibc-source'


args = docopt(__doc__)
if args['<command>'] == 'kernel':
    exit(call(['khack-kernel'] + args['<args>'], shell=True))
elif args['<command>'] == 'libc':
    exit(call(['khack-libc'] + args['<args>'], shell=True))
elif args['<command>'] == 'module':
    exit(call(['khack-module'] + args['<args>'], shell=True))
else:
    exit(call('less {}/khack/help.txt'.format(home_dir), shell=True))
